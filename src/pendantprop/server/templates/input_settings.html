<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Settings - PendantProp</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>
<body>
    <div class="header">
        <h1><i class="fas fa-droplet"></i> PendantProp</h1>
        <h2>Settings</h2>
    </div>

    <div class="settings-container">
        <form action="/update_settings" method="post">
            
            <div class="button-group">
                <button type="submit" class="btn btn-primary">
                    <i class="fas fa-save"></i> Save Settings
                </button>
                <a href="/" class="btn btn-secondary">
                    <i class="fas fa-arrow-left"></i> Cancel
                </a>
            </div>
            
            <!-- General Settings -->
            <div class="settings-section">
                <h3><i class="fas fa-sliders-h"></i> General Settings</h3>
                <div class="form-row">
                    <label for="simulate">Simulate Mode:</label>
                    <select id="simulate" name="simulate">
                        <option value="true" {% if settings.general_settings.simulate %}selected{% endif %}>Enabled</option>
                        <option value="false" {% if not settings.general_settings.simulate %}selected{% endif %}>Disabled</option>
                    </select>
                    <small>Use mock hardware for testing</small>
                </div>
                <div class="form-row">
                    <label for="refresh_rate">Refresh Rate (s):</label>
                    <input type="number" step="0.1" id="refresh_rate" name="refresh_rate" value="{{ settings.general_settings.refresh_rate }}">
                    <small>How often images and plots refresh on the web interface</small>
                </div>
            </div>

            <!-- Robot Settings -->
            <div class="settings-section">
                <h3><i class="fas fa-robot"></i> Robot Settings</h3>
                <div class="form-row">
                    <label for="robot_ip">Robot IP:</label>
                    <input type="text" id="robot_ip" name="robot_ip" value="{{ settings.robot_settings.robot_ip }}">
                    <small>IP address of the Opentrons robot</small>
                </div>
                <div class="form-row">
                    <label for="robot_type">Robot Type:</label>
                    <input type="text" id="robot_type" name="robot_type" value="{{ settings.robot_settings.robot_type }}">
                    <small>OT2 or Flex</small>
                </div>
                <div class="form-row">
                    <label for="left_pipette_name">Left Pipette:</label>
                    <input type="text" id="left_pipette_name" name="left_pipette_name" value="{{ settings.robot_settings.left_pipette_name }}">
                </div>
                <div class="form-row">
                    <label for="right_pipette_name">Right Pipette:</label>
                    <input type="text" id="right_pipette_name" name="right_pipette_name" value="{{ settings.robot_settings.right_pipette_name }}">
                </div>
                <div class="form-row">
                    <label for="well_depth_mm">Well Depth (mm):</label>
                    <input type="number" step="0.1" id="well_depth_mm" name="well_depth_mm" value="{{ settings.robot_settings.well_depth_mm }}">
                </div>
            </div>

            <!-- Wash Settings -->
            <div class="settings-section">
                <h3><i class="fas fa-tint"></i> Wash Settings</h3>
                <div class="form-row">
                    <label for="wash_volume_ul">Wash Volume (µL):</label>
                    <input type="number" id="wash_volume_ul" name="wash_volume_ul" value="{{ settings.wash_settings.wash_volume_ul }}">
                </div>
                <div class="form-row">
                    <label for="wash_repeats">Wash Repeats:</label>
                    <input type="number" id="wash_repeats" name="wash_repeats" value="{{ settings.wash_settings.wash_repeats }}">
                </div>
                <div class="form-row">
                    <label for="mixing_volume_ul">Mixing Volume (µL):</label>
                    <input type="number" id="mixing_volume_ul" name="mixing_volume_ul" value="{{ settings.wash_settings.mixing_volume_ul }}">
                </div>
                <div class="form-row">
                    <label for="mix_repeats">Mix Repeats:</label>
                    <input type="number" id="mix_repeats" name="mix_repeats" value="{{ settings.wash_settings.mix_repeats }}">
                </div>
            </div>

            <!-- Sensor Settings -->
            <div class="settings-section">
                <h3><i class="fas fa-thermometer-half"></i> Sensor Settings</h3>
                <div class="form-row">
                    <label for="serial_port">Serial Port:</label>
                    <input type="text" id="serial_port" name="serial_port" value="{{ settings.sensor_settings.serial_port }}">
                    <small>COM port for sensor (e.g., COM3)</small>
                </div>
            </div>

            <!-- Pendant Drop Settings -->
            <div class="settings-section">
                <h3><i class="fas fa-droplet"></i> Pendant Drop Settings</h3>
                <div class="form-row">
                    <label for="n_dilutions">Number of Dilutions:</label>
                    <input type="number" id="n_dilutions" name="n_dilutions" value="{{ settings.pendant_drop_settings.n_dilutions }}">
                </div>
                <div class="form-row">
                    <label for="well_volume">Well Volume (µL):</label>
                    <input type="number" id="well_volume" name="well_volume" value="{{ settings.pendant_drop_settings.well_volume }}">
                </div>
                <div class="form-row">
                    <label for="mix_repeat">Mix Repeats:</label>
                    <input type="number" id="mix_repeat" name="mix_repeat" value="{{ settings.pendant_drop_settings.mix_repeat }}">
                </div>
                <div class="form-row">
                    <label for="worthington_limit_lower">Worthington Lower Limit:</label>
                    <input type="number" step="0.01" id="worthington_limit_lower" name="worthington_limit_lower" value="{{ settings.pendant_drop_settings.worthington_limit_lower }}">
                </div>
                <div class="form-row">
                    <label for="worthington_limit_upper">Worthington Upper Limit:</label>
                    <input type="number" step="0.01" id="worthington_limit_upper" name="worthington_limit_upper" value="{{ settings.pendant_drop_settings.worthington_limit_upper }}">
                </div>
                <div class="form-row">
                    <label for="initial_drop_volume">Initial Drop Volume (µL):</label>
                    <input type="number" step="0.1" id="initial_drop_volume" name="initial_drop_volume" value="{{ settings.pendant_drop_settings.initial_drop_volume }}">
                </div>
                <div class="form-row">
                    <label for="check_time">Check Time (s):</label>
                    <input type="number" step="0.1" id="check_time" name="check_time" value="{{ settings.pendant_drop_settings.check_time }}">
                </div>
                <div class="form-row">
                    <label for="equilibration_time">Equilibration Time (s):</label>
                    <input type="number" id="equilibration_time" name="equilibration_time" value="{{ settings.pendant_drop_settings.equilibration_time }}">
                </div>
                <div class="form-row">
                    <label for="max_measure_time">Max Measure Time (s):</label>
                    <input type="number" id="max_measure_time" name="max_measure_time" value="{{ settings.pendant_drop_settings.max_measure_time }}">
                </div>
                <div class="form-row">
                    <label for="max_retries">Max Retries:</label>
                    <input type="number" id="max_retries" name="max_retries" value="{{ settings.pendant_drop_settings.max_retries }}">
                </div>
                <div class="form-row">
                    <label for="drop_volume_decrease_after_retry">Volume Decrease After Retry (µL):</label>
                    <input type="number" step="0.01" id="drop_volume_decrease_after_retry" name="drop_volume_decrease_after_retry" value="{{ settings.pendant_drop_settings.drop_volume_decrease_after_retry }}">
                </div>
                <div class="form-row">
                    <label for="drop_volume_increase_resolution">Volume Increase Resolution (µL):</label>
                    <input type="number" step="0.01" id="drop_volume_increase_resolution" name="drop_volume_increase_resolution" value="{{ settings.pendant_drop_settings.drop_volume_increase_resolution }}">
                </div>
                <div class="form-row">
                    <label for="flow_rate">Flow Rate (µL/s):</label>
                    <input type="number" step="0.01" id="flow_rate" name="flow_rate" value="{{ settings.pendant_drop_settings.flow_rate }}">
                </div>
                <div class="form-row">
                    <label for="pendant_drop_depth_offset">Depth Offset (mm):</label>
                    <input type="number" step="0.1" id="pendant_drop_depth_offset" name="pendant_drop_depth_offset" value="{{ settings.pendant_drop_settings.pendant_drop_depth_offset }}">
                </div>
                <div class="form-row">
                    <label for="well_id_drop_stage">Drop Stage Well ID:</label>
                    <input type="text" id="well_id_drop_stage" name="well_id_drop_stage" value="{{ settings.pendant_drop_settings.well_id_drop_stage }}">
                </div>
                <div class="form-row">
                    <label for="n_equilibration_points">Equilibration Points:</label>
                    <input type="number" id="n_equilibration_points" name="n_equilibration_points" value="{{ settings.pendant_drop_settings.n_equilibration_points }}">
                </div>
            </div>

            <!-- Image Analysis Settings -->
            <div class="settings-section">
                <h3><i class="fas fa-image"></i> Image Analysis Settings</h3>
                <div class="form-row">
                    <label for="scale">Scale (mm/pixel):</label>
                    <input type="number" step="0.000001" id="scale" name="scale" value="{{ settings.image_analysis_settings.scale }}">
                    <small>Conversion factor from pixels to millimeters</small>
                </div>
                <div class="form-row">
                    <label for="diameter_needle_px">Needle Diameter (px):</label>
                    <input type="number" id="diameter_needle_px" name="diameter_needle_px" value="{{ settings.image_analysis_settings.diameter_needle_px }}">
                </div>
                <div class="form-row">
                    <label for="diameter_tolerance_percent">Diameter Tolerance (%):</label>
                    <input type="number" id="diameter_tolerance_percent" name="diameter_tolerance_percent" value="{{ settings.image_analysis_settings.diameter_tolerance_percent }}">
                </div>
                <div class="form-row">
                    <label for="st_water">Surface Tension Water (mN/m):</label>
                    <input type="number" step="0.01" id="st_water" name="st_water" value="{{ settings.image_analysis_settings.st_water }}">
                </div>
                <div class="form-row">
                    <label for="density">Density (g/cm³):</label>
                    <input type="number" step="0.001" id="density" name="density" value="{{ settings.image_analysis_settings.density }}">
                </div>
                <div class="form-row">
                    <label for="gravity_constant">Gravity Constant (m/s²):</label>
                    <input type="number" step="0.00001" id="gravity_constant" name="gravity_constant" value="{{ settings.image_analysis_settings.gravity_constant }}">
                </div>
            </div>

        </form>
    </div>

    <footer>
        <p>PendantProp v2.0</p>
    </footer>
</body>
</html>
